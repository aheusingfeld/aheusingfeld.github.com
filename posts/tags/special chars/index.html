<!DOCTYPE html><!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>goldstift's blog | </title><link rel="author" href="/humans.txt"><link rel="stylesheet" href="/stylesheets/jquery.mobile-1.3.2.min.css"><link rel="stylesheet" href="/stylesheets/styles.css"><script src="/javascripts/vendor/custom.modernizr.js"></script><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--><style  type="text/css">@font-face { font-family: 'Open Sans'; font-style: normal; font-weight: 400; src: local('Open Sans'), local('OpenSans'), url(/fonts/OpenSans-Regular.woff) format('woff');}@font-face { font-family: 'Open Sans'; font-style: normal; font-weight: 700; src: local('Open Sans Bold'), local('OpenSans-Bold'), url(/fonts/OpenSans-Bold.woff) format('woff');}@font-face { font-family: 'Open Sans'; font-style: italic; font-weight: 400; src: local('Open Sans Italic'), local('OpenSans-Italic'), url(/fonts/OpenSans-Italic.woff) format('woff');}</style><link rel="alternate" type="application/atom+xml" title="goldstift\s blog" href="http://aheusingfeld.github.io/atom.xml"><link rel="shortcut icon" href="https://goldstift.de/favicon.ico?/posts/tags/special chars/" type="image/x-icon"></head><body class="clear antialiased home"><div class="wrapper" data-role="page" data-theme="d"><div class="top-panel" data-role="header" data-position="fixed" data-theme="d"><h1 class="general-title">goldstift's 2 cent on technology and software development</h1><a class="jqm-navmenu-link" href="#nav-menu-panel" data-icon="bars" data-iconpos="notext">Navigation</a></div><main data-role="content"><div class="pagination"><div class="previous" style="width:50%; float: left"><p>Previous</p></div><div class="next" style="width:50%; float: right; text-align: right"><p>Next</p></div></div><div style="clear: both"></div><article class="post" itemscope="" itemtype="http://schema.org/BlogPosting" role="article"><header><h2 itemprop="headline">Broken special chars in Spring Roo?</h2><div class="meta" aria-role="status" aria-label="Meta information on the current blog post."><span class="permalink"><a class="icon-permalink" href="/posts/2011/02/13/broken-special-chars-in-spring-roo/" itemprop="url" aria-label="Permalink for blog post Broken special chars in Spring Roo?" title="Permalink for blog post Broken special chars in Spring Roo?"><span class="linktext">"Permalink for blog post 'Broken special chars in Spring Roo?'"</span></a></span><span class="author" itemprop="author">Alexander Heusingfeld</span> <time class="pubdate" datetime="2011-02-13T22:00:00+01:00" itemprop="datePublished">13. February 2011</time></div></header><div class="addthis_sharing_toolbox"></div><section itemprop="articleBody">
<p>
This is the first post in an upcoming series of posts on Spring Roo (see footer for details an Roo).<br /><br /><h2>Problem: Special chars and Umlauts are not correctly displayed in my Roo-Application</h2>[<a href="http://goldstifts.blogspot.com/2011/02/umlaute-und-sonderzeichen-in-spring-roo.html">german version</a>]<br />There are often questions and support requests on the above named topic in <a href="http://forum.springsource.org/forumdisplay.php?f=67">Spring Roo-Forum</a>. Mostly questioners write that german "Umlauts" like ä, ö, ü and ß or other special chars in cyrillic are not correctly display or saved to the database. With the following post I'd like to review the most common sources of the problem and come up with solutions.<br /><br />





<h3>Encoding of the HTML/ JSP page</h3>Roo generated JSPs are always delivered with UTF-8 encoding. In case you write your additional JSPs by hand, you should assure these pages are also delivered to the browser in UTF-8 encoding so the form data will be correctly send on submit.<br />This can be achieved by specifying the following line of code at the beginning of each JSP:<br /><pre>&lt;jsp:directive.page contenttype="text/html;charset=UTF-8"<br />   pageencoding="UTF-8"/&gt;<br /></pre><br />To show you an example where to exactly put this, the "default.jspx", which serves a frame for all other JSP pages via Apache Tiles, contains the following lines to preserve UTF-8 encoding in the resulting HTML:<br /><pre class="alt2" dir="ltr" style="border: 1px inset; margin: 0px; overflow: auto; padding: 6px; text-align: left; width: 400px;">&lt;html xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:tiles="http://tiles.apache.org/tags-tiles" xmlns:spring="http://www.springframework.org/tags" xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" &gt;  <br /> <br /> &lt;jsp:output doctype-root-element="HTML" doctype-system="about:legacy-compat" /&gt;<br /> <br /> &lt;jsp:directive.page contentType="text/html;charset=UTF-8" /&gt;  <br />  <br /> &lt;head&gt;<br />  &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br /><br />&lt;!-- ... --&gt;<br /></pre><br />To check whether your page is delivered in UTF-8 encoding, open it in your browser and have a look at menu "View &gt; Character Encoding".<br /><br /><h3>CharacterEncodingFilter in web.xml file</h3>This is the most common point of failure. We're talking about the order in which the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;filter-mapping&gt;</span>-Tags occur in your "<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">src/main/webapp/WEB-INF/web.xml</span>". These tags define in which order the filters are executed on each HTTP-Request.<br /><b>Roo generates the correct order since Version 1.1.1! <a href="https://jira.springsource.org/browse/ROO-1731">Previous versions are still buggy</a>.</b> <br /><br />The correct order looks like the following:<br /><pre class="alt2" dir="ltr" style="border: 1px inset; margin: 0px; overflow: auto; padding: 6px; text-align: left; width: 400px;">&lt;filter-mapping&gt;<br />    &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;<br />    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />&lt;/filter-mapping&gt;<br />&lt;filter-mapping&gt;<br />    &lt;filter-name&gt;Spring OpenEntityManagerInViewFilter&lt;/filter-name&gt;<br />    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />&lt;/filter-mapping&gt;<br />&lt;filter-mapping&gt;<br />    &lt;filter-name&gt;HttpMethodFilter&lt;/filter-name&gt;<br />    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />&lt;/filter-mapping&gt;<br />&lt;filter-mapping&gt;<br />    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;<br />    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />&lt;/filter-mapping&gt;<br /></pre><br />In case you want to change the order it is important to understand at least a minimum of the inner workings of these filters:<br /><ul><li><a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/CharacterEncodingFilter.html">CharacterEncodingFilter</a> - Sets the encoding on the HTTP-Request in case the Browser didn't send the encoding of the HMTL-page/ form</li><li> <a href="http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/orm/jpa/support/OpenEntityManagerInViewFilter.html">OpenEntityManagerInViewFilter</a> - only for Hibernate, sets the EntityManager to a ThreadLocal (see <a href="http://stackoverflow.com/questions/1538222/why-not-to-use-springs-openentitymanagerinviewfilter">discussion on</a> <a href="http://heapdump.wordpress.com/2010/04/04/should-i-use-open-session-in-view/">Pros and Cons</a>)</li><li><a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html">HttpMethodFilter</a> - Necessary to really perform e.g. HTTP PUT or HTTP DELETE requests!</li><li><a href="http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html">springSecurityFilterChain</a> - has to be run AFTER HttpMethodFilter in case you check HTTP-Method in Spring Security</li><li>... other filters</li></ul>To avoid problems with the encoding of your special chars, "CharacterEncodingFilter" has to be run before any other filter has worked on the request data!<br /><b>For this reason the general advice is: the &lt;filter-mapping&gt; for <a href="http://forum.springsource.org/showthread.php?t=97672">CharacterEncodingFilter has to be at the first position in your "web.xml"</a> (<a href="https://jira.springsource.org/browse/ROO-1698">See ROO-1698 for an explanation</a> - the charset CANNOT be set to the request after the InputStream has been read)!</b> <br /><br /><h3>Database connection</h3>The last point is to assure that your application communicates with the database via unicode with a default encoding of UTF-8.<br /><br />As Roo generates the correct connection string for MySQL since "the early days" there haven't been many bugs with this lately.<br />The connection string can be configured in "<span style="font-size: x-small;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">src/main/resources/META-INF/spring/database.properties</span></span>" and looks like the following for MySQL:<br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">database.url=jdbc:mysql://[YOUR_DB_SERVER]:3306/[YOUR_DB_NAME]?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=UTF-8</span><br /><br /><h3>Conclusion</h3>Since version 1.1.1 Spring Roo provides a (by now) bug free support for special chars and umlauts, which as been tested with various languages worldwide.<br /><br />If you have any questions on Spring Roo or the topic named above you can find competent assistance in the Roo-Forum. <br /><br /><h3>References/ Links used in the text</h3><ul style="font-family: inherit;"><li><a href="https://jira.springsource.org/browse/ROO">ROO-JIRA issues</a></li><ul><li><a href="https://jira.springsource.org/browse/ROO-89">https://jira.springsource.org/browse/ROO-89</a> </li><li><a href="https://jira.springsource.org/browse/ROO-1030">https://jira.springsource.org/browse/ROO-1030</a></li><li><a href="https://jira.springsource.org/browse/ROO-1585">https://jira.springsource.org/browse/ROO-1585</a>&nbsp; </li><li><a href="https://jira.springsource.org/browse/ROO-1684">https://jira.springsource.org/browse/ROO-1684</a></li><li><a href="https://jira.springsource.org/browse/ROO-1698">https://jira.springsource.org/browse/ROO-1698</a> </li><li><a href="https://jira.springsource.org/browse/ROO-1731">https://jira.springsource.org/browse/ROO-1731</a></li></ul><li>Threads in <a href="http://forum.springsource.org/forumdisplay.php?f=67">ROO-Forum</a></li><ul><li><a href="http://forum.springsource.org/showthread.php?t=101926">http://forum.springsource.org/showthread.php?t=101926</a>&nbsp;</li><li><a href="http://forum.springsource.org/showthread.php?t=97672">http://forum.springsource.org/showthread.php?t=97672</a></li></ul><li>Other</li><ul><li><a href="http://heapdump.wordpress.com/2010/04/04/should-i-use-open-session-in-view/">http://heapdump.wordpress.com/2010/04/04/should-i-use-open-session-in-view/</a></li><li><a href="http://stackoverflow.com/questions/1538222/why-not-to-use-springs-openentitymanagerinviewfilter">http://stackoverflow.com/questions/1538222/why-not-to-use-springs-openentitymanagerinviewfilter</a><br /></li></ul></ul><br /><blockquote><a href="http://www.springsource.org/roo">Spring Roo</a> is a Code-Generation-Tool for Software development in Java. It is a lightweight developer tool that makes it fast and easy to deliver instant results. Best of all, you code 100% in Java and get to reuse all your existing Java knowledge, skills and experience.<br /><br />There are already many Add-Ons available to customize Roo to your special needs. In case you don't find an Add-On that fits your needs, you can easily create your own Add-On in just a few steps.<br /><br /></blockquote>  <p><script type="text/javascript">var dzone_url = 'http://goldstifts.blogspot.com/2011/02/broken-special-chars-in-spring-roo.html';</script><script type="text/javascript">var dzone_style = '2';</script><script language="javascript" src="http://widgets.dzone.com/links/widgets/zoneit.js"></script>  </p>
</p>
<p><a href="/posts/2011/02/13/broken-special-chars-in-spring-roo/" class="continue" title="Broken special chars in Spring Roo?">Go to "Broken special chars in Spring Roo?"</a></p></section><section class="tags" role="menu" aria-label="List of linked tags" itemprop="keywords"><i class="label icon-tags">tags: </i><a href="/posts/tags/java" role="menuitem">java, </a><a href="/posts/tags/spring" role="menuitem">spring, </a><a href="/posts/tags/roo" role="menuitem">roo, </a><a href="/posts/tags/special chars" role="menuitem">special chars, </a><a href="/posts/tags/servletfilter" role="menuitem">servletfilter </a></section><footer></footer></article><div class="pagination"><div class="previous" style="width:50%; float: left"><p>Previous</p></div><div class="next" style="width:50%; float: right; text-align: right"><p>Next</p></div></div><h3 style="clear: both; text-align: center;">My next Conferences</h3><div class="lanyrd-target-splat" style="margin: 1em auto; max-width: 25em;"><a href="https://lanyrd.com/profile/aheusingfeld/" class="lanyrd-splat lanyrd-number-3 lanyrd-type-speaking lanyrd-context-future" rel="me">view more on Lanyrd</a></div></main><section id="nav-menu-panel" data-role="panel" data-position="left" data-display="reveal" data-theme="c"><h3><Blog>Posts</Blog></h3><nav><ul class="innernav" data-role="listview" data-inset="true" role="menu"><li role="menuitem"><a href="/">Home</a></li><li role="menuitem"><a href="/about/">About Me</a></li><li class="divider" role="separator"></li><li class="post" role="menuitem"><span class="date">22 Dec 2016</span><a href="/posts/2016/12/22/owncloud-updates-between-multiple-major-versions/">&raquo;  Owncloud Updates between multiple Major Versions</a></li><li class="post" role="menuitem"><span class="date">08 May 2015</span><a href="/posts/2015/05/08/per-request-debugging-with-log4j2/">&raquo;  Per request debugging with Log4j 2 filters</a></li><li class="post" role="menuitem"><span class="date">31 Jan 2015</span><a href="/posts/2015/01/31/migrate-owncloud/">&raquo;  Migrate Owncloud from PostgreSQL to MySQL</a></li><li class="post" role="menuitem"><span class="date">08 Oct 2014</span><a href="/posts/2014/10/08/innoq-company-culture/">&raquo;  Article on company culture at innoQ</a></li><li class="post" role="menuitem"><span class="date">06 Sep 2014</span><a href="/posts/2014/09/06/personal-reset/">&raquo;  Personal Reset</a></li><li class="post" role="menuitem"><span class="date">10 Sep 2013</span><a href="/posts/2013/09/10/First-steps-with-android/">&raquo;  First Steps with Android</a></li><li class="post" role="menuitem"><span class="date">08 Aug 2013</span><a href="/posts/2013/08/08/speaking-at-DOAG-SIG-Middleware/">&raquo;  Speaking at DOAG SIG Middleware 2013</a></li><li class="post" role="menuitem"><span class="date">06 Aug 2013</span><a href="/posts/2013/08/06/getting-started-with-clojure/">&raquo;  Getting started with Clojure</a></li><li class="post" role="menuitem"><span class="date">13 Jul 2013</span><a href="/posts/2013/07/13/speaking-at-javaone2013/">&raquo;  Speaking at JavaOne 2013</a></li><li class="post" role="menuitem"><span class="date">27 Jun 2013</span><a href="/posts/2013/06/27/postfix-and-etc-hosts/">&raquo;  Postfix and /etc/hosts</a></li><li class="post" role="menuitem"><span class="date">25 Apr 2013</span><a href="/posts/2013/04/25/collaborator-on-sonar-intellij-plugin/">&raquo;  Collaborator on Sonar IntelliJ Plugin</a></li><li class="post" role="menuitem"><span class="date">21 Apr 2013</span><a href="/posts/2013/04/21/speaking-at-javaforum-stuttgart/">&raquo;  I'm speaking at Java Forum Stuttgart 2013</a></li><li class="post" role="menuitem"><span class="date">20 Mar 2013</span><a href="/posts/2013/03/20/Mac-OS-X-for-java-developers/">&raquo;  Mac OS X setup tips & tricks</a></li><li class="post" role="menuitem"><span class="date">13 Dec 2012</span><a href="/posts/2012/12/13/Glassfish4-on-Nexus7/">&raquo;  Glassfish 4 on Nexus7</a></li><li class="post" role="menuitem"><span class="date">30 Nov 2012</span><a href="/posts/2012/11/30/Ubuntu+Java-on-Nexus7/">&raquo;  Ubuntu and Java on Nexus7</a></li><li class="post" role="menuitem"><span class="date">26 Nov 2012</span><a href="/posts/2012/11/26/Productivity-for-Finder/">&raquo;  Enhancements for Mac OS X Finder.app</a></li><li class="post" role="menuitem"><span class="date">03 Nov 2012</span><a href="/posts/2012/11/03/JBoss-Forge-in_IntelliJ/">&raquo;  JBoss Forge in IntelliJ IDEA</a></li><li class="post" role="menuitem"><span class="date">09 Oct 2012</span><a href="/posts/2012/10/09/JavaOne_Session-material-online/">&raquo;  JavaOne 2012 Session material is now available</a></li><li class="post" role="menuitem"><span class="date">25 Sep 2012</span><a href="/posts/2012/09/25/JavaOne/">&raquo;  Getting ready for JavaOne 2012</a></li><li class="post" role="menuitem"><span class="date">13 Mar 2012</span><a href="/posts/2012/03/13/alternative-zu-google-vielleicht-duckduckgo/">&raquo;  Alternative zu Google? Vielleicht DuckDuckGo</a></li><li class="post" role="menuitem"><span class="date">24 Oct 2011</span><a href="/posts/2011/10/24/springroo-howto-translate-java-exceptions-to-user-friendly-error-messages/">&raquo;  SpringRoo - Howto translate Java exceptions to user-friendly error messages</a></li><li class="post" role="menuitem"><span class="date">01 Oct 2011</span><a href="/posts/2011/10/01/iphone-wartezeit-f-r-rufumleitung-bei-abwesenheit-setzen/">&raquo;  iPhone - Wartezeit für Rufumleitung bei Abwesenheit setzen</a></li><li class="post" role="menuitem"><span class="date">25 Sep 2011</span><a href="/posts/2011/09/25/springroo-entity-klassen-und-jpa-repositories-mit-springroo-erstellen/">&raquo;  SpringRoo - Entity-Klassen und JPA-Repositories mit SpringRoo erstellen</a></li><li class="post" role="menuitem"><span class="date">23 Sep 2011</span><a href="/posts/2011/09/23/starting-photooapp-a-springroo-tutorial-application/">&raquo;  Starting PhotooApp - A SpringRoo tutorial application</a></li><li class="post" role="menuitem"><span class="date">05 Jun 2011</span><a href="/posts/2011/06/05/praxistipps-zu-ftplicity/">&raquo;  Praxistipps zu ftplicity</a></li><li class="post" role="menuitem"><span class="date">03 Jun 2011</span><a href="/posts/2011/06/03/how-to-set-default-comment-security-level-in-atlassian-jira/">&raquo;  How to Set Default Comment Security Level in Atlassian JIRA</a></li><li class="post" role="menuitem"><span class="date">13 Feb 2011</span><a href="/posts/2011/02/13/broken-special-chars-in-spring-roo/">&raquo;  Broken special chars in Spring Roo?</a></li><li class="post" role="menuitem"><span class="date">10 Feb 2011</span><a href="/posts/2011/02/10/umlaute-und-sonderzeichen-in-spring-roo/">&raquo;  Umlaute und Sonderzeichen in Spring Roo?</a></li><li class="post" role="menuitem"><span class="date">19 Jan 2011</span><a href="/posts/2011/01/19/probleme-beim-login-ins-elster-eportal-mit-mac-os-x/">&raquo;  Probleme beim Login ins Elster ePortal mit Mac OS X</a></li><li class="post" role="menuitem"><span class="date">22 Apr 2009</span><a href="/posts/2009/04/22/-letztlich-doch-hier/">&raquo;  ...letztlich doch hier</a></li></ul></nav></section><footer><small>&copy; 2014 by <a href="/about/">Alex Heusingfeld</a> - Hosted on <a href="https://github.com/aheusingfeld/aheusingfeld.github.io">GitHub Pages</a>, build via <a href="https://travis-ci.org/aheusingfeld/aheusingfeld.github.io/">Travis CI</a></small></footer></div><script type="text/javascript" src="/javascripts/jquery-1.10.2.min.js"></script><script type="text/javascript" src="/javascripts/jquery.mobile-1.3.2.min.js"></script><script type="text/javascript" src="/javascripts/scale.fix.js"></script><script type="text/javascript" src="//cdn.lanyrd.net/badges/person-v1.min.js"></script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=goldstift" async="async"></script></body></html>